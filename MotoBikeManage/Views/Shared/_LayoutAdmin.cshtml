﻿
<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>N2D SHOP</title>
    <link rel="shortcut icon" type="image/png" href="../assets/images/logos/favicon.png" />
    <link rel="stylesheet" href='@Url.Content("~/assets/css/styles.min.css")' />
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
</head>
<body>
    <!--  Body Wrapper -->
    <div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
         data-sidebar-position="fixed" data-header-position="fixed">
        <!-- Sidebar Start -->
        <aside class="left-sidebar">
            <!-- Sidebar scroll-->
            <div>
                <div class="brand-logo d-flex align-items-center justify-content-between">
                    <a href="@Url.Action("Index","Admin","Admin")" class="text-nowrap logo-img">
                        @*<img src="../assets/images/logos/dark-logo.svg" width="180" alt="" />*@
                        <img src='@Url.Content("~/assets/images/logos/logo1.png")' width="180" height="80" alt="" />
                    </a>
                    <div class="close-btn d-xl-none d-block sidebartoggler cursor-pointer" id="sidebarCollapse">
                        <i class="ti ti-x fs-8"></i>
                    </div>
                </div>
                <!-- Sidebar navigation-->
                <nav class="sidebar-nav scroll-sidebar" data-simplebar="">
                    <ul id="sidebarnav">
                        <li class="nav-small-cap">
                            <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                            <span class="hide-menu">Home</span>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="@Url.Action("Index","Admin","Admin")" aria-expanded="false">
                                <span>
                                    <img src='@Url.Content("~/assets/images/products/dashboard.png")'
                                         alt="" style="width: 40px; height: 40px;" />
                                </span>
                                <span class="hide-menu">Dashboard</span>
                            </a>
                        </li>
                        <li class="nav-small-cap">
                            <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                            <span class="hide-menu">Quản Lí Chung</span>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="@Url.Action("List","QLNhanVien","Admin")" aria-expanded="false">
                                <span>
                                    <img src='@Url.Content("~/assets/images/products/account.png")' alt="" style="width: 40px; height: 40px;" />
                                </span>
                                <span class="hide-menu">Tài Khoản Nhân Viên</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="@Url.Action("ListNCC","QLNCC","Admin")" aria-expanded="false">
                                <span>
                                    <img src='@Url.Content("~/assets/images/products/supplier.png")' alt="" style="width: 40px; height: 40px;" />
                                </span>
                                <span class="hide-menu">Nhà Cung Cấp</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="@Url.Action("Index","Vehicles")" aria-expanded="false">
                                <span>
                                    <img src='@Url.Content("~/assets/images/products/motorbike.png")' alt="" style="width: 40px; height: 40px;" />
                                </span>
                                <span class="hide-menu">Xe Máy</span>
                            </a>
                        </li>
                        <li class="nav-small-cap">
                            <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                            <span class="hide-menu">Quản Lí Kho</span>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./authentication-login.html" aria-expanded="false">
                                <span>
                                    <img src='@Url.Content("~/assets/images/products/inventory.png")' alt="" style="width: 40px; height: 40px;" />
                                </span>
                                <span class="hide-menu">Tồn Kho</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./authentication-register.html" aria-expanded="false">
                                <span>
                                    <img src='@Url.Content("~/assets/images/products/import.png")' alt="" style="width: 40px; height: 40px;" />
                                </span>
                                <span class="hide-menu">Nhập Kho</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./authentication-register.html" aria-expanded="false">
                                <span>
                                    <img src='@Url.Content("~/assets/images/products/logistics.png")' alt="" style="width: 40px; height: 40px;" />
                                </span>
                                <span class="hide-menu">Xuất Kho</span>
                            </a>
                        </li>
                        <li class="nav-small-cap">
                            <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
                            <span class="hide-menu">Quản Lí Báo Cáo, Thống Kê</span>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./icon-tabler.html" aria-expanded="false">
                                <span>
                                    <img src='@Url.Content("~/assets/images/products/monitor.png")' alt="" style="width: 40px; height: 40px;" />
                                </span>
                                <span class="hide-menu">Báo Cáo, Thống Kê</span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="./sample-page.html" aria-expanded="false">
                                <span>
                                    <img src='@Url.Content("~/assets/images/products/predictive.png")' alt="" style="width: 40px; height: 40px;" />
                                </span>
                                <span class="hide-menu">Bảo Trì</span>
                            </a>
                        </li>
                    </ul>
                    <div class="unlimited-access hide-menu bg-light-primary position-relative mb-7 mt-5 rounded">
                        <div class="d-flex">
                            <div class="unlimited-access-title me-3">
                                <h6 class="fw-semibold fs-4 mb-6 text-dark w-85">Upgrade to pro</h6>
                                <a href="https://adminmart.com/product/modernize-bootstrap-5-admin-template/" target="_blank" class="btn btn-primary fs-2 fw-semibold lh-sm">Buy Pro</a>
                            </div>
                            <div class="unlimited-access-img">
                                <img src='@Url.Content("~/assets/images/backgrounds/rocket.png")' alt=""
                                     class="img-fluid">
                            </div>
                        </div>
                    </div>
                </nav>
                <!-- End Sidebar navigation -->
            </div>
            <!-- End Sidebar scroll-->
        </aside>
        <!--  Sidebar End -->
        <!--  Main wrapper -->
        <div class="body-wrapper">
            <!--  Header Start -->
            <header class="app-header" style="position: fixed; top: 0;">
                <nav class="navbar navbar-expand-lg navbar-light">
                    <ul class="navbar-nav">
                        <li class="nav-item d-block d-xl-none">
                            <a class="nav-link sidebartoggler nav-icon-hover" id="headerCollapse" href="javascript:void(0)">
                                <i class="ti ti-menu-2"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link nav-icon-hover" href="javascript:void(0)">
                                <i class="ti ti-bell-ringing"></i>
                                <div class="notification bg-primary rounded-circle"></div>
                            </a>
                        </li>
                    </ul>
                    <div class="navbar-collapse justify-content-end px-0" id="navbarNav">
                        <ul class="navbar-nav flex-row ms-auto align-items-center justify-content-end">
                            <span class="navbar-text" style="font:caption">
                                Xin chào, @Session["FullName"]
                            </span>
                            <li class="nav-item dropdown">
                                <a class="nav-link nav-icon-hover" href="javascript:void(0)" id="drop2" data-bs-toggle="dropdown"
                                   aria-expanded="false">
                                    <img src="@Url.Content(Session["Image"] as string)" alt="" width="45" height="45" class="rounded-circle" />
                                </a>
                                <div class="dropdown-menu dropdown-menu-end dropdown-menu-animate-up" aria-labelledby="drop2">
                                    <div class="message-body">
                                        <a class="d-flex align-items-center gap-2 dropdown-item"
                                           data-bs-toggle="modal"
                                           data-bs-target="#myProfileModal">
                                            <i class="ti ti-user fs-6"></i>
                                            <p class="mb-0 fs-3">My Profile</p>
                                        </a>
                                        <a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
                                            <i class="ti ti-mail fs-6"></i>
                                            <p class="mb-0 fs-3">My Account</p>
                                        </a>
                                        <a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
                                            <i class="ti ti-list-check fs-6"></i>
                                            <p class="mb-0 fs-3">My Task</p>
                                        </a>
                                        <a href="@Url.Action("Logout","Admin","Admin")" class="btn btn-outline-primary mx-3 mt-2 d-block">Logout</a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
            </header>
            <!-- Div trống để chừa chỗ cho navbar -->
            <div class="header-placeholder" style="height: 70px;"></div>
            <!-- RenderBody() hiển thị nội dung chung của các trang -->
            @RenderBody()
        </div>
        <div class="py-6 px-6 text-center" style="margin-top:30%; offset-position:center">
            <p class="mb-0 fs-4">Design and Developed by <a href="https://XeMayN2D.com/" target="_blank" class="pe-1 text-primary text-decoration-underline">XeMayN2D.com</a> Distributed by <a href="https://themewagon.com">ThemeWagon</a></p>
        </div>
    </div>
    <!-- Modal: My Profile -->
    <div class="modal fade" id="myProfileModal" tabindex="-1" aria-labelledby="myProfileModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <!-- Tiêu đề Modal -->
                <div class="modal-header">
                    <h5 class="modal-title" id="myProfileModalLabel">Chỉnh sửa thông tin tài khoản</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <!-- Form: Gửi đến Action EditProfile -->
                @using (Html.BeginForm("EditProfile", "Admin", "Admin", FormMethod.Post, new { @id = "formEditProfile", enctype = "multipart/form-data" }))
                {
                    @Html.AntiForgeryToken()

                    @Html.Hidden("Id", Session["Id"]) <!-- Dùng Id để tìm user -->

                    <!-- Giữ đường dẫn cũ phòng khi không upload mới -->
                    @Html.Hidden("OldAvatarPath", Session["Image"])

          <!-- Lớp ngoài canh giữa nội dung -->
<div class="text-center mb-4">
  <!-- Lớp trong dùng inline-block + position relative để icon camera hiển thị góc -->
  <div style="position: relative; margin: 0 auto; display: inline-block;">
      <!-- Ảnh đại diện -->
      <img id="avatarImg"
           src="@Url.Content(Session["Image"] as string)"
           style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover;"
           class="mx-auto d-block" />

      <!-- Icon camera nằm ở góc phải dưới -->
      <label style="
         position: absolute;
         bottom: 0;
         right: 0;
         background-color: #fff;
         border-radius: 50%;
         width: 32px;
         height: 32px;
         display: flex;
         align-items: center;
         justify-content: center;
         cursor: pointer;
         box-shadow: 0 0 4px rgba(0,0,0,0.3);" 
         title="Chỉnh sửa ảnh đại diện">
        <i class="ti ti-camera"></i>
        <input type="file" 
               name="AvatarFile" 
               style="display: none;" 
               accept="image/*" 
               onchange="previewAvatar(event)" />
      </label>
  </div>
</div>
                    <!-- Hidden field Id hoặc Username (để tìm user) -->
                    @Html.Hidden("Id", Session["Id"])

                    <!-- Thông tin của user (full_name, email, phone, v.v.) -->
                    <div class="row mb-3" style="margin-left:3px" >
                        <div class="col-6">
                            <label class="form-label"><strong>Họ và tên:</strong></label>
                            <input type="text" name="FullName" class="form-control"
                                   value="@Session["FullName"]" />
                        </div>
                        <div class="col-6">
                            <label class="form-label"><strong>Email:</strong></label>
                            <input type="email" name="Email" class="form-control"
                                   value="@Session["Email"]"  />
                        </div>
                    </div>

                    <div class="row mb-3" style="margin-left:3px" >
                        <div class="col-6" >
                            <label class="form-label"><strong>Số điện thoại:</strong></label>
                            <input type="text" name="Phone" class="form-control"
                                   value="@Session["Phone"]" />
                        </div>
                        <div class="col-6">
                            <label class="form-label"><strong>Quyền (Role):</strong></label>
                            <input type="text" name="Role" class="form-control"
                                   value="@Session["Role"]" readonly />
                        </div>
                    </div>


                    <!-- Nút Lưu & Đóng -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                        <button type="submit" class="btn btn-primary">Lưu thay đổi</button>
                    </div>
                }
            </div>
        </div>
    </div>

    <!-- Script preview ảnh -->
    <script type="text/javascript">
        function previewAvatar(event) {
            let fileInput = event.target;
            if (fileInput.files && fileInput.files[0]) {
                let reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('avatarImg').src = e.target.result;
                };
                reader.readAsDataURL(fileInput.files[0]);
            }
        }

    </script>
    <!-- Thay đường dẫn tương đối bằng Url.Content cho JS -->
    <script src='@Url.Content("~/assets/libs/jquery/dist/jquery.min.js")'></script>
    <script src='@Url.Content("~/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js")'></script>
    <script src='@Url.Content("~/assets/js/sidebarmenu.js")'></script>
    <script src='@Url.Content("~/assets/js/app.min.js")'></script>
    <script src='@Url.Content("~/assets/libs/apexcharts/dist/apexcharts.min.js")'></script>
    <script src='@Url.Content("~/assets/libs/simplebar/dist/simplebar.js")'></script>
    <script src='@Url.Content("~/assets/js/dashboard.js")'></script>
</body>
</html>