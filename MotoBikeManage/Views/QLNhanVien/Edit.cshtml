@model MotoBikeManage.Models.User

@{
    ViewBag.Title = "Chỉnh sửa thông tin nhân viên";
    Layout = null;
    // Giả định Layout đã có sẵn link tới Bootstrap, FontAwesome, jQuery...
}

<!-- Bootstrap CSS -->
<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      integrity="sha384-ENjdO4Dr2bkBst7lkKHUq6g5FYg+iQ9J2Q2ZBiamo0y5Ih8P160xIm9lZfAuNx33"
      crossorigin="anonymous" />

<!-- Font Awesome for icons -->
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      integrity="sha512-Fo3rlrZj/k7ujTnH2N2dmCTrtTa4zlXI9Oy5qF9TRlfz4N1pq/exZbh75tzdfT29yyZNZb6F4kn9glS+ZVK9Yg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer" />

<style>
    body {
        background-color: #f9f9f9;
    }

    .edit-form-container {
        width: 350px;
        margin: 40px auto;
        background: #fff;
        border-radius: 8px;
        padding: 25px 30px;
        box-shadow: 0 0 10px rgba(0,0,0,0.15);
    }

    h2.form-title {
        text-align: center;
        margin-bottom: 20px;
        font-weight: 600;
        color: #333;
    }
    /* Xóa border của input-group ở dưới, ta sẽ thêm thủ công */
    .input-group {
        border-bottom: 1px solid #ccc;
        margin-bottom: 18px;
    }
    /* Căn icon sang phải nên input đi trước, icon đi sau */
    /* Bỏ background mặc định của .input-group-text để hòa với ô input */
    .input-group-text {
        background: none;
        border: none;
        color: #666;
    }

    .form-control {
        border: none;
        outline: none;
        box-shadow: none;
        font-size: 14px;
        color: #555;
        padding-right: 35px;
        background: transparent;
    }

        .form-control::placeholder {
            color: #999;
        }

    .icon-right i {
        position: absolute;
        right: 0;
        top: 0;
        height: 100%;
        display: flex;
        align-items: center;
        padding-right: 5px;
        color: #666;
        cursor: pointer;
        font-size: 16px; /* Kích cỡ icon */
    }
    /* Chỉnh nút thành inline-flex, bỏ width:100% */
    .button-row {
        display: flex;
        justify-content: space-between; /* Hoặc space-around / center */
        gap: 10px;
        margin-top: 20px;
    }

    .btn-submit, .btn-cancel {
        flex: 1; /* Chia đều chiều rộng hoặc tùy chỉnh */
        border-radius: 20px;
        border: none;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        padding: 10px 0;
    }

    .btn-cancel {
        display: flex;
        text-decoration: none;
        align-content: center;
        justify-content: center;
        border-radius: 20px;
        border: none;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        padding: 10px 0;
    }

    .btn-submit {
        background: #4e8ef7;
        color: #fff;
    }

        .btn-submit:hover {
            background: #3e7ee0;
        }

    .btn-cancel {
        background: #FF0000;
        color: #fff;
    }

        .btn-cancel:hover {
            background: #cc0000;
        }
    /* Upload ảnh và xem trước */
    .avatar-container {
        margin-bottom: 18px;
    }

    #avatarPreview {
        display: block;
        margin: 10px 0 0 auto; /* canh phải */
        border-radius: 8px;
        width: 80px;
        height: 80px;
        object-fit: cover;
        border: 1px solid #ccc;
    }
</style>

<div class="edit-form-container">
    <h2 class="form-title">CẬP NHẬT LẠI THÔNG TIN</h2>

    @using (Html.BeginForm("Edit", "QLNhanVien", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        @Html.AntiForgeryToken()
        @Html.HiddenFor(model => model.id)

        <!-- Họ và Tên -->
        <div class="input-group">
            @Html.TextBoxFor(m => m.full_name, new { @class = "form-control", placeholder = "Họ và tên" })
            <span class="input-group-text">
                <i class="fa fa-user" style="justify-items:right"></i>
            </span>
        </div>

        <!-- Số điện thoại -->
        <div class="input-group">
            @Html.TextBoxFor(m => m.phone, new { @class = "form-control", placeholder = "Số điện thoại" })
            <span class="input-group-text">
                <i class="fa fa-phone"></i>
            </span>
        </div>

        <!-- Email -->
        <div class="input-group">
            @Html.TextBoxFor(m => m.email, new { @class = "form-control", placeholder = "Email" })
            <span class="input-group-text">
                <i class="fa fa-envelope"></i>
            </span>
        </div>

        <!-- Mật khẩu -->
        <div class="input-group">
            @Html.PasswordFor(m => m.password, new { @class = "form-control", placeholder = "Mật khẩu mới" })
            <span class="input-group-text">
                <i class="fa fa-lock"></i>
            </span>
        </div>

        <!-- Upload avatar -->
        <div class="avatar-container">
            <label><i class="fa fa-image"></i> Ảnh đại diện (nếu muốn thay)</label>
            <input type="file" id="avatarFile" name="avatarFile" class="form-control" style="border:none;" />
            <img id="avatarPreview" src="" alt="Preview" style="display:none;" />
        </div>

        <!-- Nếu có ảnh cũ trong DB -->
        if (!string.IsNullOrEmpty(Model.avatar))
        {
            <div>
                <label>Ảnh hiện tại:</label><br />
                <img src="@Url.Content(Model.avatar)" alt="Avatar" width="80" height="80" style="border-radius: 8px; border:1px solid #ccc; object-fit: cover;" />
            </div>
        }

        <!-- Nút -->
        <div class="button-row">
            <button type="submit" class="btn-submit">LƯU</button>
            <a href="@Url.Action("List", "QLNhanVien")" class="btn-cancel text-center">HỦY</a>
        </div>
    }
</div>

@section scripts {
    <script>
        $(document).ready(function () {
            // Hiển thị ảnh preview khi chọn file
            $("#avatarFile").change(function () {
                var file = this.files[0];
                if (file) {
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        $("#avatarPreview").attr("src", e.target.result).show();
                    }
                    reader.readAsDataURL(file);
                } else {
                    $("#avatarPreview").hide();
                }
            });
        });
    </script>
}